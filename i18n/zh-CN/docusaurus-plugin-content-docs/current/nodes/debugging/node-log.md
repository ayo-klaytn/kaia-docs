# 节点日志

本页详细介绍了 Kaia 节点的一些重要或常见问题日志。
如果 Kaia 日志被修改或新增/删除，请同时编辑此页面。

有关日志类型的详细信息，请参阅 [log_modules.go](https://github.com/kaiachain/kaia/blob/dev/log/log_modules.go)

如果您遇到任何异常情况，请通过 [github](https://github.com/kaiachain/kaia/issues)、[Kaia 论坛](https://devforum.kaia.io/) 或 [Discord](https://discord.com/KaiaOfficial) 向 kaia 团队报告。

## 错误日志

| 日志类型      | 节点类型     | 日志信息                                                                                                                                                                                                                                                                                                                                           | 说明                                                                                                                                                  | 建议指南                                                                                                                  |
| :-------- | :------- | :--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-------------------------------------------------------------------------------------------------------------------------------------------------- | :-------------------------------------------------------------------------------------------------------------------- |
| 区块链       | CN/PN/EN | ########## BAD BLOCK #########Chain config： %v<br/><br/>编号： %v哈希值：0x%x%v<br/><br/>错误：%v##############################                                                                                                                                                                                                                          | 当接收到的收据和执行结果不一致时，就会出现坏块。 如果节点停止时出现坏块日志，可能有两个原因。  <br/>- 案例 1. 节点配置错误，如二进制版本。  <br/>- 案例 2. 代码有问题。 其他节点很可能也会遇到同样的问题。 | 此错误非常严重，因此如果您发现任何坏块，请向 Kaia GitHub 仓库提交问题或报告。                                                                         |
| 伊斯坦布尔核心共识 | CN/PN/EN | **从超时通道丢弃空信息**                                                                                                                                                                                                                                                                                                                                 | 这意味着换轮计时器将过期。 如果计时器意外关闭，则会打印此错误信息。                                                                                                                  | 错误可能在启动下载程序时发生。  检查并打印下一条日志："块同步开始"。                                                                                  |
| 网络P2P     | CN/PN/EN | \*\* istanbul/64 协议失败\*\* id=04680a827fa1b240 conn=staticdial err="写 tcp 10.117.2.105:34396->10.117.2.27:32323: use of closed etwork connection"<br/><br/>\*\* istanbul/64 协议失败\*\* err="正在关闭" | 当另一个节点断开连接时，可以打印该日志。 其后通常会出现 "断开 P2P 对等体 "日志。                                                                                                       | 检查断开的对等设备是否再次连接。 如果没有重新连接，请检查网络状态或对等网络连接 [admin_peers](../../../references/json-rpc/admin/peers) |
| 节点 CN     | CN       | \*\* SendNewBlockHashes**失败 err="write tcp 10.117.2.124:24108->10.117.2.108:32323: use of closed network connection"<br/><br/>** SendNewBlockHashes\*\*失败 err="正在关闭"                           | 与 "伊斯坦布尔/64 协议失败 "相同                                                                                                                                | 与 "伊斯坦布尔/64 协议失败 "相同                                                                                                  |
| 节点 CN     | CN       | **发送NewBlock失败** peer=d35220eccdb0de7b err="正在关闭"                                                                                                                                                                                                                                                                                              | 与 "伊斯坦布尔/64 协议失败 "相同                                                                                                                                | 与 "伊斯坦布尔/64 协议失败 "相同                                                                                                  |
| 网络        | 英文（大部分）  | **FastWebsocketHandler 升级失败消息** error="websocket: version != 13"                                                                                                                                                                                                                                                               | WebSocket 连接的版本问题                                                                                                                                   | 请求头应包含 "Sec-Websocket-Version "字段，其值设为 13。 您可能没有使用过 kaia rpc 客户端。                                                     |

## 警告日志

| 日志类型      | 节点类型     | 日志信息                                                                                                                                                                                                                                                                                                                                                  | 说明                                                                             | 建议指南                                                                                                                                       |
| :-------- | :------- | :---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :----------------------------------------------------------------------------- | :----------------------------------------------------------------------------------------------------------------------------------------- |
| 区块链       | CN/PN/EN | **升级数据库版本** 从=N/A 到=3                                                                                                                                                                                                                                                                                                                                 | 它记录在节点启动的开始阶段                                                                  | 你不需要处理这些。                                                                                                                                  |
| 伊斯坦布尔核心共识 | CN       | \*\*[RC]\*\*轮=                                                                                                                                                                                                                                                                                    | 回合更改日志以 [RC] 标记开始。         | 如果一轮或两轮没有结束，而是继续上升，则应首先分析网络状态或对等连接。  同行连接检查 api：[admin_peers](../../../references/json-rpc/admin/peers)               |
| 伊斯坦布尔核心共识 | CN       | **意外请求** address= state="接受请求" seq=312 err="旧信息" number=311 hash=d960ea…6df6de                                                                                                                                                                                                                                                                        | 提议者埋下了地雷，但结果却出乎意料。 在大多数情况下，它太旧了，不可能是新块。                                        | 你不需要处理这些。                                                                                                                                  |
| 节点        | CN/PN/EN | **doConnTypeHandshake** 失败 addr=10.117.2.252:28516 conn=inbound conntype=-1 err="读取 tcp 10.117.2.78:32324->10.117.2.252:28516: i/o 超时 | 通过拨号，两个 P2P 对等方建立起连接。 如果设置失败，将打印此日志。                                           | 检查断开的对等设备是否再次连接。 如果没有，请检查网络状态或对等连接对等连接检查 api: [admin_peers](../../../references/json-rpc/admin/peers) |
| 节点 CN     | PN/EN    | **过滤体失败** peer=c02e4b4d471c56b9 lenTxs=1                                                                                                                                                                                                                                                                                                              | 一个节点在获取正文时收到了不需要的块标头。  - lenTxs：未请求的 tx 数量                                     | 你不需要处理这些。                                                                                                                                  |
| 工作        | CN       | **由于时间限制，交易中止** hash=                                                                                                                                                                                                                                                                                                                                 | 挖矿时区块的执行时间不应超过 250 毫秒，因此最后一笔交易可能会因为这个时间限制而中止。                                  | 确认交易进入区块。                                                                                                                                  |
| 工作        | CN       | **交易失败，账户被跳过** hash=b1b26c...6b220a err="转账余额不足"<br/><br/>Error(before v1.6.2)<br/>Warn(after v1.6.2)                                                                                           | 在挖矿过程中，由于 "from "账户余额不足，交易无法执行（理论上，当交易创建并进入 txpool 时余额充足，但实际执行时余额不足，就会出现这种情况）。 | 检查 "from "账户是否真的失去平衡。                                                                                                                      |

## 信息日志

信息 "日志包含附加信息，可让您更多地了解节点状态，因此您无需处理 "信息 "级日志。

| 日志类型    | 节点类型     | 日志信息                                                                                                                                                                                                                                                 | 说明                                                                                                                                                                                                                                                                                                                                                                                                                                |
| :------ | :------- | :--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| 区块链     | CN/PN/EN | **重新生成本地交易日志** 交易=0 账户=0                                                                                                                                                                                                                             | 节点关闭时，本地 tx 会被记录到一个文件中（默认文件名为 transactions.rlp）。 当节点使用日志文件重新启动时，本地事务可根据该文件重新生成。  - 事务：再生本地事务的编号。  - 账户：再生账户的数量（==从）                                                                                                                                                                                                                                                                                               |
| 区块链     | CN/PN/EN | **插入一个新块** 编号=14 hash=13cbfc…f007fc txs=0 gas=0 elapsed=793.458µs processTxs=167ns finalize=157.708µs validateState=7.542µs totalWrite=443.417µs trieWrite=256.667µs | 如果该节点不是该区块的提议者，且共识成功，则该节点已执行（==验证）该区块。 换句话说，就是插入一个数据块。  - gas：执行 tx 过程中消耗的气体总量。  该字段在测试网络时通常用于查找每个区块的用气量。                                                                                                                                                                                                                                                                                                                         |
| 网络P2P   | CN/PN/EN | **[拨号]从静态节点添加拨号候选** id=62a08a4b9f091c4b NodeType=0 ip=10.117.2.8 mainPort=32323 port=[32323] | 连接了一个新的 P2P 对等节点，它是一个静态节点。 使用 static-nodes.json 或 addpeer api 手动添加的节点称为静态节点。 如果是多通道，则使用两个端口。 ex. [32323, 32324].  - id: dst 对等节点 id - NodeType: dst 节点类型（cn,pn,en,bn） - ip: dst ip - mainPort: dst TCP 监听端口号 - port: dst TCP 监听端口号，包括主端口和子端口。 |
| 网络P2P   | CN/PN/EN | \*\* 添加了一个多通道 P2P 对等体\*\* id=28a6760472a078fb conn=staticdial peerID=28a6760472a078fb                                                                                                                                                                | 新对等点作为多通道对等点连接。  - id/peerID：我的节点的对等 ID -conn：连接类型 -inbound：有人连接我 -staticdial：静态连接，如 static-nodes.json 或 addPeer -trustdial：信任连接，如 trust-nodes.json。 即使连接数超过了最大限制，也可以始终重新连接并建立连接。                                                                                                                                                                                                                 |
| 网络P2P   | CN/PN/EN | **断开一个多通道 P2P Peer** id=28a6760472a078fb conn=inbound peerID=28a6760472a078fb peerName=Kaia/v1.7.3+acae89350c/darwin-arm64/go1.18.1 err=EOF                                          | 多通道对等设备断开连接。  - peerName：它显示了我的节点信息 - 错误：连接断开的原因                                                                                                                                                                                                                                                                                                                                                                                  |
| 网络P2P   | CN/PN/EN | **ProtocolManager.processConsensusMsg closed** id=28a6760472a078fb conn=inbound PeerName=Kaia/v1.7.3+acae89350c/darwin-arm64/go1.18.1                                | 当一个 P2P 节点断开连接时，它们之间的共识信息通道也会关闭。                                                                                                                                                                                                                                                                                                                                                                                                  |
| 存储状态数据库 | CN/PN/EN | **内存数据库中的持续三元组** blockNum=23460 updated nodes=4 updated nodes size=499.00B time=539.959µs gcnodes=68 gcsize=10.55kB gctime=226.499µs livenodes=245 livesize=37.80kB  | 打印此日志是为了通知您 trie db 已提交。 在这里，提交指的是将数据库更改刷新到实际数据库中。  定期提交。  - 案例 1. 如果节点是全节点，则每 128 个区块进行一次 trie 提交。  - 案例 2. 如果节点是存档节点，则会对每个区块进行 trie 提交。  承诺也是在接下来的情况下做出的。  - , 节点关闭时会进行一次提交。  - 当内存大小超过上限时，就会进行提交。  小贴士  - gc 代表垃圾收集。 在这里，垃圾回收指的是刷新三节点变化的数据库写入。  - 全节点存储每 128 个周期和最近 128 个区块的信息。  - 存档节点存储每个区块的信息。                                                                                              |
| 工作      | CN       | **提交新的采矿工作** number=14 hash=438ef7…68ca7f txs=0 elapsed=605.375µs commitTime=184.708µs finalizeTime=414.375µs                                                                                        | 每个 CN 都会挖掘一个区块，为轮换做准备 - number：区块编号 - hash：区块哈希值（不是最终版本） - txs：区块中的事务数量 - elapsed：区块挖掘总时间（commitTime + finalizeTime） - commitTime：区块中的事务执行时间 - finalizeTime：区块最终确定时间                                                                                                                                                                                                                                                              |
| 工作      | CN       | **成功封存新区块** 编号=14 hash=13cbfc…f007fc                                                                                                                                                                                                                 | [唯一投标人] 封闭新区块成功。 密封包含接下来的步骤。  - 区块的 Ibft 共识进程。  - 更新区块的时间戳和签名                                                                                                                                                                                                                                                                                                                 |
| 工作      | CN       | **成功写入已挖掘区块** num=14 hash=13cbfc…f007fc txs=0 elapsed=617.709µs                                                                                                                                                                      | [仅提议者] 如果节点是提议者，并且共识成功，提议者需要将区块执行结果存储到数据库中。 该日志表示存储成功。                                                                                                                                                                                                                                                                                                                        |
| 工作      | CN       | **太遥远的未来** 等待=1 秒                                                                                                                                                                                                                                    | 为了保持 1 秒钟的区块创建周期，节点的休眠时间为 "1 秒-上一个区块的生成/传播/执行时间"。  - 等待：节点的休眠时间                                                                                                                                                                                                                                                                                                                                                                   |
| 虚拟机     | CN/PN/EN | **由于 addr 不是程序账户，因此返回** addr=                                                                                                                                                                                                                        | 有人试图调用不存在的合同。  小贴士 在 Kaia 中，程序账户等同于合同账户。                                                                                                                                                                                                                                                                                                                                                                                          |
