# 節點日誌

本頁詳細說明 Kaia 節點的一些重要或常見問題日誌。
如果 Kaia 日誌有修改或新增/刪除，請同時編輯此頁。

有關日誌類型的詳細資訊，您可以參考 [log_modules.go](https://github.com/kaiachain/kaia/blob/dev/log/log_modules.go)

如果您遇到任何異常狀況，請透過 [github](https://github.com/kaiachain/kaia/issues)、[Kaia 論壇](https://devforum.kaia.io/) 或 [Discord](https://discord.com/KaiaOfficial) 向 kaia 團隊報告。

## 錯誤記錄

| 日誌類型        | 節點類型                        | 日誌訊息                                                                                                                                                                                                                                                                                                                                                | 說明                                                                                                                                                        | 建議指南                                                                                                                |
| :---------- | :-------------------------- | :-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-------------------------------------------------------------------------------------------------------------------------------------------------------- | :------------------------------------------------------------------------------------------------------------------ |
| 區塊鏈         | CN/PN/EN                    | ########## BAD BLOCK #########Chain config： %v<br/><br/>Number: %vHash: 0x%x%v<br/><br/>Error: %v##############################                                                                                                                                                                     | 當接收到的收據和執行結果不一致時，就會發生壞區塊。 如果節點因區塊記錄不良而停止，可能有兩個原因。  <br/>- 案例 1. 節點的組態是錯誤的，例如二進位版本。  <br/>- 案例 2. 程式碼有問題 其他節點很可能也會遇到相同的問題。 | 這個錯誤很重要，所以如果您看到任何壞的區塊，請提出問題或回報到 Kaia GitHub 套件庫。                                                                    |
| 伊斯坦堡核心共識    | CN/PN/EN                    | **從超時頻道丟丟空訊息**                                                                                                                                                                                                                                                                                                                                      | 這表示換輪計時器將會過期。 如果計時器意外關閉，則會列印此錯誤訊息。                                                                                                                        | 錯誤可能在啟動下載器時發生。  檢查下一個記錄也會列印：`Block synchronisation started`。                                                        |
| 網路P2P       | CN/PN/EN                    | **協定 istanbul/64 失敗** id=04680a827fa1b240 conn=staticdial err="write tcp 10.117.2.105:34396->10.117.2.27:32323: use of closed etwork connection「<br/><br/>**協定 istanbul/64 失敗** err=」shutting down" | 當另一個節點斷線時，可以列印此記錄。 其後通常會出現 `Disconnected a P2P Peer` 日誌。                                                                                                  | 檢查斷開的對等端是否又重新連線。 如果沒有重新連線，請檢查網路狀態或對等連線 [admin_peers](../../../references/json-rpc/admin/peers) |
| NodeCN      | CN                          | \*\* SendNewBlockHashes**失敗 err="write tcp 10.117.2.124:24108->10.117.2.108:32323: use of closed network connection「<br/><br/>** SendNewBlockHashes\*\*失敗 err=」shutting down"                       | 與 `Protocol istanbul/64 failed` 相同                                                                                                                        | 與 `Protocol istanbul/64 failed` 相同                                                                                  |
| NodeCN      | CN                          | \*\* SendNewBlock\*\*失敗 peer=d35220eccdb0de7b err=「關機中」                                                                                                                                                                                                                                                                                             | 與 `Protocol istanbul/64 failed` 相同                                                                                                                        | 與 `Protocol istanbul/64 failed` 相同                                                                                  |
| NetworksRPC | EN (大部分) | **FastWebsocketHandler 升級失敗訊息** error="websocket: version != 13"                                                                                                                                                                                                                                                                    | WebSocket 連線的版本問題                                                                                                                                         | 請求的標頭應包含 `Sec-Websocket-Version` 欄位，其值設定為 13。 您可能尚未使用 kaia rpc 用戶端。                                                 |

## 警告日誌

| 日誌類型     | 節點類型     | 日誌訊息                                                                                                                                                                                                                                                                                                                                                             | 說明                                                                                                    | 建議指南                                                                                                                                          |
| :------- | :------- | :--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :---------------------------------------------------------------------------------------------------- | :-------------------------------------------------------------------------------------------------------------------------------------------- |
| 區塊鏈      | CN/PN/EN | **升級資料庫版本** 從=N/A 到=3                                                                                                                                                                                                                                                                                                                                            | 它會在節點啟動開始時記錄。                                                                                         | 你不需要處理這個                                                                                                                                      |
| 伊斯坦堡核心共識 | CN       | **[RC]** round=                                                                                                                                                                                                                                                                                              | Round 變更日誌以 [RC] 標籤開始。                            | 如果一輪或兩輪都沒有結束，而且持續上升，則應先分析網路狀態或對等連線。  對等連線檢查 api: [admin_peers](../../../references/json-rpc/admin/peers) |
| 伊斯坦堡核心共識 | CN       | \*\* 非預期請求\*\* address= state="Accept request" seq=312 err=「舊訊息」 number=311 hash=d960ea…6df6de                                                                                                                                                                                                                                                                   | 提案者埋下一個障礙，但結果卻出乎意料。 在大多數情況下，它太舊了，不可能是新的區塊。                                                            | 你不需要處理這個                                                                                                                                      |
| 節點       | CN/PN/EN | **Failed doConnTypeHandshake** addr=10.117.2.252:28516 conn=inbound conntype=-1 err="read tcp 10.117.2.78:32324->10.117.2.252:28516: i/o timeout | 透過撥號，兩個 P2P 對等體建立連線。 如果設定失敗，則會列印此日誌。                                                                  | 檢查斷開的對等端是否又重新連線。 如果沒有，請檢查網路狀態或對等連線對等連線檢查 api: [admin_peers](../../../references/json-rpc/admin/peers)    |
| NodeCN   | PN/EN    | **過濾體失敗** peer=c02e4b4d471c56b9 lenTxs=1                                                                                                                                                                                                                                                                                                                         | 當擷取時，節點收到不想要的正文區塊標頭。  - lenTxs：非要求的 tx 數量                                                             | 你不需要處理這個                                                                                                                                      |
| 工作       | CN       | \*\* 交易因時間限制而中止\*\* hash=                                                                                                                                                                                                                                                                                                                                        | 挖礦時區塊的執行時間不能超過 250ms，所以最後一個交易可能會因為這個時間限制而中止。                                                          | 確認交易進入區塊。                                                                                                                                     |
| 工作       | CN       | \*\* 交易失敗，帳戶被跳過\*\* hash=b1b26c...6b220a err="insufficient balance for transfer"<br/><br/>Error(before v1.6.2)<br/>Warn(after v1.6.2)                                                                      | 當交易在挖礦過程中因為 `from` 帳戶中的餘額不足而無法執行時 (理論上，當交易建立並進入 txpool 時餘額足夠，但實際執行時餘額不足，就會發生這種情況)。 | 檢查 `from` 帳戶是否真的失去平衡。                                                                                                                         |

## 資訊日誌

`Info` 日誌包含額外的資訊，讓您可以知道更多關於節點狀態的資訊，所以您不需要處理 `Info` 層級的日誌。

| 日誌類型    | 節點類型     | 日誌訊息                                                                                                                                                                                                                                                      | 說明                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| :------ | :------- | :-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| 區塊鏈     | CN/PN/EN | \*\* 重新產生本機交易日誌\*\* 交易=0 帳戶=0                                                                                                                                                                                                                             | 關閉節點時，本機 tx 會記錄到一個檔案 (預設檔案名稱為 transactions.rlp)。 當使用日誌檔案重新啟動節點時，本機事務可以根據檔案重新產生。  - transactions：重新產生的本機交易數量。  - accounts: 重新生成的帳號數量(==from)                                                                                                                                                                                                                                          |
| 區塊鏈     | CN/PN/EN | \*\* 插入新區塊\*\* 編號=14 hash=13cbfc…f007fc txs=0 gas=0 elapsed=793.458µs processTxs=167ns finalize=157.708µs validateState=7.542µs totalWrite=443.417µs trieWrite=256.667µs  | 如果該節點不是該區塊的提案者，且共識成功，則該節點已執行 (==validates) 該區塊。 換句話說，會插入一個區塊。  - gas：執行 tx 時所消耗的總氣體。  此欄位通常用於測試網路，以找出每個區塊使用的瓦斯。                                                                                                                                                                                                                                                                                                                         |
| 網路P2P   | CN/PN/EN | **[Dial] 新增來自靜態節點的撥號候選** id=62a08a4b9f091c4b NodeType=0 ip=10.117.2.8 mainPort=32323 port=[32323] | 連接了一個新的 P2P 對等點，它是一個靜態節點。 使用 static-nodes.json 或 addpeer api 手動新增的節點稱為靜態節點。 如果是多通道，則使用兩個連接埠。 ex. [32323, 32324].  - id: dst 對等節點 id - NodeType: dst 節點類型(cn,pn,en,bn) - ip: dst ip - mainPort: dst TCP 聆聽連接埠號碼 - port: dst TCP 聆聽連接埠號碼，包括主連接埠和子連接埠。 |
| 網路P2P   | CN/PN/EN | \*\* 新增一個多通道 P2P 對等\*\* id=28a6760472a078fb conn=staticdial peerID=28a6760472a078fb                                                                                                                                                                       | 新對等端以多通道對等端連接。  - id/peerID: 我的節點的對等者 ID - conn: 連線類型 - inbound: 有人連線我 - staticdial: 靜態連線，例如 static-nodes.json 或 addPeer - trusteddial: 可信賴的連線，例如 trust-nodes.json。 即使連線數量超過最大限制，也可以隨時重新連線並建立連線。                                                                                                                                           |
| 網路P2P   | CN/PN/EN | \*\* 斷開一個多通道 P2P 對等\*\* id=28a6760472a078fb conn=inbound peerID=28a6760472a078fb peerName=Kaia/v1.7.3+acae89350c/darwin-arm64/go1.18.1 err=EOF                                            | 多通道對等斷線。  - peerName：它顯示我的節點資訊 - 錯：連線中斷的原因                                                                                                                                                                                                                                                                                                                                                                                                                 |
| 網路P2P   | CN/PN/EN | **ProtocolManager.processConsensusMsg closed** id=28a6760472a078fb conn=inbound PeerName=Kaia/v1.7.3+acae89350c/darwin-arm64/go1.18.1                                     | 當 P2P 節點斷線時，它們之間的共識訊息通道也會關閉。                                                                                                                                                                                                                                                                                                                                                                                                                               |
| 儲存狀態資料庫 | CN/PN/EN | \*\* 來自記憶體資料庫的暫存 trie\*\* blockNum=23460 更新節點=4 更新節點 size=499.00B time=539.959µs gcnodes=68 gcsize=10.55kB gctime=226.499µs livenodes=245 livesize=37.80kB                | 列印此日誌是為了通知您 trie db 已經提交。 在這裡，commit 表示將 db 變更匯入實際的 db。  定期進行提交。  - 案例 1. 如果節點是完整節點，則會針對每 128 個區塊進行 trie commit。  - 案例 2. 如果節點是歸檔節點，則會對每個區塊進行 trie commit。  承諾也是在下一種情況下做出的。  - , 節點關閉時會進行提交。  - 當記憶體大小超過上限時，就會進行提交。  提示。  - gc 代表垃圾回收。 這裡，垃圾回收是指清除 trie 節點變更時的 db 寫入。  - 一個完整節點儲存每 128 個週期和最新 128 個區塊的資訊。  - 歸檔節點儲存每個區塊的資訊。                                                                                                |
| 工作      | CN       | \*\* 提交新的採礦工作\*\* number=14 hash=438ef7…68ca7f txs=0 elapsed=605.375µs commitTime=184.708µs finalizeTime=414.375µs                                                                                        | 每個 CN 都會挖一個區塊，為輪轉作準備 - number：區塊編號 - hash：區塊切細值（它不是最終版本） - txs：區塊中的交易數量 - elapsed：總的區塊挖礦時間（commitTime + finalizeTime） - commitTime：區塊中的交易執行時間 - finalizeTime：區塊最終完成時間                                                                                                                                                                                                                                                                                      |
| 工作      | CN       | \*\* 成功封存新區塊\*\* 編號=14 hash=13cbfc…f007fc                                                                                                                                                                                                                 | [Only Proposer] 封裝新區塊成功。 封裝包含接下來的步驟。  - 區塊的 Ibft 共識程序。  - 更新區塊的時間戳記和簽名                                                                                                                                                                                                                                                                                                                                 |
| 工作      | CN       | **成功寫入已挖掘的區塊** num=14 hash=13cbfc…f007fc txs=0 elapsed=617.709µs                                                                                                                                                                          | [Only Proposer] 如果節點是 Proposer，而且共識成功，則 Proposer 需要將區塊執行結果存入資料庫。 此日誌表示儲存成功。                                                                                                                                                                                                                                                                                                                            |
| 工作      | CN       | \*\* 未來開採太遙遠\*\* 等待=1 秒                                                                                                                                                                                                                                   | 為了維持 1 秒的區塊建立週期，節點會休眠「1 秒 - 前一個區塊的產生/傳播/執行時間」。  - wait：節點休眠的時間                                                                                                                                                                                                                                                                                                                                                                                             |
| VM      | CN/PN/EN | **由於 addr 不是程式帳號，因此返回** addr=                                                                                                                                                                                                                             | 有人試圖調用一個不存在的合同。  提示。 在 Kaia 中，程式帳戶等同於合約帳戶。                                                                                                                                                                                                                                                                                                                                                                                                                 |
