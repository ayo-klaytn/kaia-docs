# 価値移転

**TxTypeValueTransfer**は、ユーザーがKAIAを送信したいときに使用される。

* kaiaは、各トランザクションタイプが単一の目的を果たすように複数のトランザクションタイプを提供しているため、TxTypeValueTransferは、KAIAを外部所有口座（EOA）に送信するように制限されている。

# 手数料の委任

<CH.Spotlight>
  <CH.Code>
    ```js TxTypeFeeDelegatedValueTransfer.js
    import { createWalletClient, http, kairos, privateKeyToAccount, TxType } from "@kaiachain/viem-ext";

    const senderWallet = createWalletClient({
      chain: kairos,
      transport: http(),
      account: privateKeyToAccount(
        "0x0e4ca6d38096ad99324de0dde108587e5d7c600165ae4cd6c2462c597458c2b8"
      ),
    })
    const feePayerWallet = createWalletClient({
      chain: kairos,
      transport: http(),
      account: privateKeyToAccount(
        "0x9435261ed483b6efa3886d6ad9f64c12078a0e28d8d80715c773e16fc000cff4"
      ),
    });
    (async () => {
      const txRequest = await senderWallet.prepareTransactionRequest({
        account: senderWallet.account,
        to: "0x70997970c51812dc3a010c7d01b50e0d17dc79c8",
        value: 0n,
        type: TxType.FeeDelegatedValueTransfer,
      });
      const signedTx = await senderWallet.signTransaction(txRequest);
      console.log("signedTx", signedTx);

      const feePayerSignedTx = await feePayerWallet.signTransactionAsFeePayer(
        signedTx
      );
      const res = await feePayerWallet.request({
        method: "kaia_sendRawTransaction",
        params: [feePayerSignedTx],
      });
      console.log("fee delegated value transfer tx", res);
    })();


    ```

    ---

    ```zsh output
    ❯ js TxTypeFeeDelegatedValueTransfer.js
    signedTx 0x09f88082095285066720b30082cd149470997970c51812dc3a010c7d01b50e0d17dc79c88094a2a8854b1802d8cd5de631e690817c253d6a9153f847f8458207f5a0c67b0c0ccf4276ad4b97d9da0e66e02bd540647c23866af148f338ef27ac2087a074f32e734fd7c2fae46221b13815bdc201c17b77c5060348b9fb26d5502456d5
    fee delegated value transfer tx 0xcdb3051c9dc60147fd0aef4838f1f3cd907aa42105dedd817c2fba31cb40981a

    ```
  </CH.Code>

  ---

  web3にkaiaの機能を追加するために\*\*@kaiachain/viem-ext\*\*パッケージをインポートする。

  ```js TxTypeFeeDelegatedValueTransfer.js focus=1
  ```

  ---

  Kairosチェーン\*\*、**HTTPトランスポート**、および**送信者の秘密鍵**をアカウントに変換した**createWalletClient**を使用して、送信者と料金支払者のウォレットを設定します。

  ```js TxTypeFeeDelegatedValueTransfer.js focus=3:16
  ```

  ---

  prepareTransactionRequest**を使用して、送金人の口座、受取人のアドレス、送金する価値（この例では0 KLAY）、およびトランザクションタイプ**(TxType.FeeDelegatedValueTransfer)\*\*を指定して、価値送金のトランザクションリクエストを作成する。

  ```js TxTypeFeeDelegatedValueTransfer.js focus=18:23
  ```

  ---

  ウォレットクライアントの **signTransaction** メソッドでトランザクションに署名し、トランザクションハッシュを記録する。

  <CH.Code>
    ```js TxTypeFeeDelegatedValueTransfer.js focus=24:25
    ```

    ---

    ```zsh output
    signedTx 0x09f88082095285066720b30082cd149470997970c51812dc3a010c7d01b50e0d17dc79c88094a2a8854b1802d8cd5de631e690817c253d6a9153f847f8458207f5a0c67b0c0ccf4276ad4b97d9da0e66e02bd540647c23866af148f338ef27ac2087a074f32e734fd7c2fae46221b13815bdc201c17b77c5060348b9fb26d5502456d5
    ```
  </CH.Code>

  ---

  手数料の支払者は、関数 `signTransactionAsFeePayer` を用いて、送信者からの署名済みのトランザクションに署名し、トランザクショ ン手数料の支払いに同意する。

  ```js TxTypeFeeDelegatedValueTransfer.js focus=27:29
  ```

  ---

  kaia_sendRawTransaction\`メソッドを使用して、完全に署名された手数料委譲トランザクション（送信者と手数料支払者の両方が署名）をKairosブロックチェーンネットワークに送信し、トランザクションハッシュまたはネットワークからの応答を返します。

  <CH.Code>
    ```js TxTypeFeeDelegatedValueTransfer.js focus=24:25
    ```

    ---

    ```zsh output
    fee delegated value transfer tx 0xcdb3051c9dc60147fd0aef4838f1f3cd907aa42105dedd817c2fba31cb40981a

    ```
  </CH.Code>
</CH.Spotlight>
