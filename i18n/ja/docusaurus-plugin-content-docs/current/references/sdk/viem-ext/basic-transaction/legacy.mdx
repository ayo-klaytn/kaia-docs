# レガシー

import { RoutePath } from '@site/src/common/codesandbox'
import Editor from '@site/src/components/Editor'

<Editor module="/src/pages/viem-ext/basic-transaction/LegacyTransaction.tsx" route={RoutePath.ViemExt_Legacy_Transaction} />

**TxTypeLegacyTransaction**は、kaiaに以前存在したトランザクションのタイプを表す。

この種の取引は、アカウントの作成、トークンの送金、スマートコントラクトの展開、スマートコントラクトの実行、または前述の組み合わせの実行が可能である。

<CH.Spotlight>
  <CH.Code>
    ```js txTypeLegacyTransaction.js
    import { createWalletClient, http, kairos, privateKeyToAccount } from "@kaiachain/viem-ext";

    const legacyWallet = createWalletClient({
      chain: kairos,
      transport: http(),
      account: privateKeyToAccount(
        "0x28d06bfebe5447d798ec7d1f208a045a15a1d6872b2a3cbb74cc896817bbb90d"
      ),
    });
    (async () => {
      // legacy tx
      const legacyRequest = await legacyWallet.prepareTransactionRequest({
        to: "0x70997970c51812dc3a010c7d01b50e0d17dc79c8",
        value: 0,
      });

      console.log("populated legacy request", legacyRequest);

      const sentLegacyTx = await legacyWallet.sendTransaction(legacyRequest);
      console.log("value transfer legacy tx", sentLegacyTx);
    })();

    ```

    ---

    ```zsh output
    ❯ node txTypeLegacyTransaction.js
    populated legacy request {
      to: '0x70997970c51812dc3a010c7d01b50e0d17dc79c8',
      value: 0,
      from: '0x7642e9D6F533DCd6F4c20EF7bA83141b6b210d83',
      nonce: 18,
      chainId: 1001,
      type: 'eip1559',
      maxPriorityFeePerGas: 0n,
      maxFeePerGas: 30000000000n,
      gas: 21000n
    }
    value transfer legacy tx 0x8da12ab374d592715df3bbf6cc96f11a836175daf0dec7f26295d172d6206056

    ```
  </CH.Code>

  ---

  web3にkaiaの機能を追加するために\*\*@kaiachain/viem-ext\*\*パッケージをインポートする。

  ```js txTypeLegacyTransaction.js focus=1
  ```

  ---

  createWalletClient**を使用してウォレットクライアントをセットアップし、**Kairosチェーン**、**HTTPトランスポート**、および**送信者の秘密鍵\*\*をアカウントに変換して設定します。

  ```js txTypeLegacyTransaction.js focus=3:9
  ```

  ---

  prepareTransactionRequest**を使用して、受信者アドレスと転送する**値\*\*（この例では0）を指定し、**レガシー値転送**のトランザクション要求を作成する。

  <CH.Code>
    ```js txTypeLegacyTransaction.js focus=12:17
    ```

    ---

    ```zsh output
    populated legacy request {
      to: '0x70997970c51812dc3a010c7d01b50e0d17dc79c8',
      value: 0,
      from: '0x7642e9D6F533DCd6F4c20EF7bA83141b6b210d83',
      nonce: 18,
      chainId: 1001,
      type: 'eip1559',
      maxPriorityFeePerGas: 0n,
      maxFeePerGas: 30000000000n,
      gas: 21000n
    }
    ```
  </CH.Code>

  ---

  ウォレットクライアントの**sendTransaction**メソッドを使用して、レガシートランザクションに署名してカイアブロックチェーンに送信し、トランザクションハッシュを記録する。

  <CH.Code>
    ```js txTypeLegacyTransaction.js focus=19:20
    ```

    ---

    ```zsh output
    ❯ node txTypeLegacyTransaction.js
    value transfer legacy tx 0x8da12ab374d592715df3bbf6cc96f11a836175daf0dec7f26295d172d6206056
    ```
  </CH.Code>
</CH.Spotlight>
